# 飞书分享插件 - 测试指南

## 🧪 测试前准备

### 1. 安装插件到 Obsidian

**步骤：**
1. 找到您的 Obsidian 笔记库位置
2. 进入 `.obsidian/plugins/` 目录
3. 创建文件夹 `obsidian-feishu-share`
4. 将以下文件复制到该文件夹：
   - `main.js` (构建生成的文件)
   - `manifest.json`
   - `styles.css` (如果有)

**文件检查清单：**
```
.obsidian/plugins/obsidian-feishu-share/
├── main.js          ✅ 必需
├── manifest.json    ✅ 必需
└── styles.css       ⚠️ 可选
```

### 2. 启用插件

1. 打开 Obsidian
2. 进入 设置 → 第三方插件
3. 关闭"安全模式"（如果开启的话）
4. 在已安装插件列表中找到"飞书分享"
5. 点击开关启用插件

### 3. 准备飞书应用信息

**您需要准备：**
- ✅ 飞书应用的 App ID
- ✅ 飞书应用的 App Secret
- ✅ 确认重定向 URL 已设置为：`obsidian://feishu-share-callback`

## 🔧 配置测试

### 测试 1：插件基础配置

**目标：** 验证插件是否正确加载和配置

**步骤：**
1. 在 Obsidian 中，进入 设置 → 第三方插件 → 飞书分享
2. 检查是否能看到设置界面
3. 填入您的 App ID 和 App Secret
4. 观察配置状态提示

**预期结果：**
- ✅ 设置界面正常显示
- ✅ 输入 App ID 和 App Secret 后显示"应用配置已完成"
- ✅ 授权按钮变为可点击状态

**如果失败：**
- 检查 Obsidian 开发者控制台（Ctrl/Cmd + Shift + I）的错误信息
- 确认插件文件是否正确复制

### 测试 2：OAuth 授权流程

**目标：** 验证飞书授权是否正常工作

**步骤：**
1. 在插件设置中点击"开始授权"按钮
2. 观察是否弹出飞书授权页面
3. 在飞书页面中登录并确认授权
4. 返回 Obsidian 查看授权状态

**预期结果：**
- ✅ 点击授权按钮后弹出飞书授权页面
- ✅ 飞书页面显示正确的应用信息和权限范围
- ✅ 授权成功后 Obsidian 显示"飞书授权成功！"通知
- ✅ 设置界面显示"已授权"状态和用户信息

**如果失败：**
- 检查 App ID 和 App Secret 是否正确
- 确认飞书应用的重定向 URL 配置
- 查看浏览器和 Obsidian 控制台的错误信息

## 📝 功能测试

### 测试 3：基础分享功能

**目标：** 验证 Markdown 文档能否成功分享到飞书

**步骤：**
1. 在 Obsidian 中打开 `测试文档.md`
2. 点击右上角菜单（三个点）
3. 查找并点击"分享到飞书"选项
4. 观察分享过程和结果

**预期结果：**
- ✅ 菜单中显示"分享到飞书"选项
- ✅ 点击后显示"正在分享到飞书..."提示
- ✅ 分享成功后显示成功通知，包含飞书文档链接
- ✅ 点击链接能打开飞书文档
- ✅ 飞书文档内容与原 Markdown 文件基本一致

**如果失败：**
- 确认授权状态是否正常
- 检查网络连接
- 查看控制台错误信息

### 测试 4：文件夹选择功能

**目标：** 验证文件夹选择界面是否正常工作

**步骤：**
1. 在插件设置中点击"选择文件夹"按钮
2. 观察文件夹选择模态框
3. 尝试浏览不同文件夹
4. 选择一个文件夹并确认

**预期结果：**
- ✅ 点击后弹出文件夹选择模态框
- ✅ 能看到飞书云空间的文件夹列表
- ✅ 面包屑导航正常工作
- ✅ 能进入子文件夹并返回
- ✅ 选择文件夹后设置界面更新

**如果失败：**
- 检查是否有 `drive:explorer:readonly` 权限
- 确认网络连接正常
- 查看控制台错误信息

### 测试 5：内容处理验证

**目标：** 验证 Obsidian 特有语法的转换效果

**步骤：**
1. 分享 `测试文档.md` 到飞书
2. 在飞书中查看文档内容
3. 对比原文档和飞书文档的差异

**预期结果：**
- ✅ 标准 Markdown 格式正常显示
- ✅ `[[双向链接]]` 转换为 `📝 链接名`
- ✅ `![[嵌入文件]]` 转换为 `📎 嵌入文件：文件名`
- ✅ 网络图片正常显示
- ✅ 本地图片显示为提示文本

## 🐛 常见问题排查

### 问题 1：插件无法加载

**症状：** 在插件列表中看不到"飞书分享"插件

**排查步骤：**
1. 检查文件路径是否正确
2. 确认 `manifest.json` 格式是否正确
3. 查看 Obsidian 控制台错误信息
4. 重启 Obsidian

### 问题 2：授权失败

**症状：** 点击授权按钮没有反应或授权页面报错

**排查步骤：**
1. 检查 App ID 和 App Secret 是否正确
2. 确认飞书应用的重定向 URL 配置
3. 检查应用权限是否已申请
4. 查看浏览器控制台错误信息

### 问题 3：分享失败

**症状：** 点击分享后显示错误信息

**排查步骤：**
1. 确认授权状态是否正常
2. 检查网络连接
3. 查看错误码对应的具体原因
4. 尝试重新授权

## 📊 测试报告模板

请按以下格式记录测试结果：

```
## 测试环境
- Obsidian 版本：
- 操作系统：
- 飞书应用类型：企业自建应用/个人应用

## 测试结果
### 配置测试
- [ ] 插件加载：成功/失败
- [ ] 应用配置：成功/失败
- [ ] OAuth 授权：成功/失败

### 功能测试
- [ ] 基础分享：成功/失败
- [ ] 文件夹选择：成功/失败
- [ ] 内容处理：成功/失败

### 发现的问题
1. 问题描述：
   - 复现步骤：
   - 错误信息：
   - 解决方案：

## 建议改进
1. 
2. 
3. 
```

## 🔄 下一步

测试完成后，请告诉我：
1. 哪些功能工作正常
2. 遇到了什么问题
3. 有什么改进建议

我会根据您的测试反馈进一步优化插件功能！
